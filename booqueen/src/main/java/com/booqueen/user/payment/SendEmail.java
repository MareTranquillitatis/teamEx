package com.booqueen.user.payment;

import java.util.Properties;
import java.util.logging.Level;
import java.util.logging.Logger;

import javax.mail.Authenticator;
import javax.mail.Message;
import javax.mail.PasswordAuthentication;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage;

import org.springframework.beans.factory.annotation.Autowired;

import com.booqueen.user.payment.service.PaymentService;
import com.booqueen.user.payment.vo.EmailVO;

public class SendEmail {
	
	@Autowired
	PaymentService paymentService;
	
	public void reservationEmail(String merchant) throws Exception {
		
		EmailVO emailVO = paymentService.getReservationInfo(merchant);
		
		Properties properties = new Properties();
		
		properties.put("mail.smtp.auth", "true");
		properties.put("mail.smtp.starttls.enable", "true");
		properties.put("mail.smtp.host", "smtp.gmail.com");
		properties.put("mail.smtp.port", "587");
		
		// 발신
		String sender = "lsh01020@gmail.com";
		String password = "rbrzfeijlyfdshqy";
		
		Session session = Session.getInstance(properties, new Authenticator() {
			@Override
			protected PasswordAuthentication getPasswordAuthentication() {
				return new PasswordAuthentication(sender, password);
			}
		});
		
		Message message = prepareMessage(session, sender, emailVO);	
		
		// 메일 전송
		Transport.send(message);
		System.out.println("Message send successfully!");
		
	}
	
	private Message prepareMessage(Session session, String sender, EmailVO emailVO) {
		try {
			Message message = new MimeMessage(session);
			message.setFrom(new InternetAddress(sender));
			message.setRecipient(Message.RecipientType.TO, new InternetAddress(emailVO.getEmail()));
			
			String subject = "감사합니다!" + emailVO.getHotelname() + "예약이 확정되었습니다";
			message.setSubject(subject);
			
			String content = "<table cellpadding='0' cellspacing='0' style='min-width:100%;' width='100%'><tbody><tr><td align='center' height='100%' style='background-color:#003580;' width='100%'><table align='center' cellpadding='0' cellspacing='0' style='max-width:640px;' width='100%'><tbody><tr><td style='padding: 0px 8px;'><table align='left' cellpadding='0' cellspacing='0' style='max-width:144px;'><tbody><tr><td style='padding:22px 0 0 0;'><a href='https://www.booking.com/index.ko.html?aid=304142;label=gen000nr-10CBYoggI46AdIF1gEaLgCiAEBmAEzuAEFyAEF2AED6AEB-AEBiAIBqAIBuALoiLKQBsACAdICJDUxMjVkMjMzLTI1YzgtNDBiZS04Y2UyLWRjZDdlMDAxNDIwZtgCAeACAQ;conf_email_logo=1&amp;' style='display:inline-block;font-family:Arial,Helvetica,sans-serif;font-size:22px;color:#FFFFFF;font-weight:600;text-decoration:none;' target='_blank' rel='noreferrer noopener'>Booqueen.com</a></td></tr><tr><td height='22'><img alt=''  height='22' src='/read/image/original/?mimeSN=1647753411.968094.6675.63232&amp;offset=84394&amp;size=1284&amp;u=sohui_lee&amp;cid=6d856060a91c5274ddded88596557f6948e4c189bb3905dd0eabf9026f5650ca@MIME-Lite-HTML-1.25&amp;contentType=image/png&amp;filename=attach%282%29.png&amp;org=1' width='1'></td></tr></tbody></table><table align='right' cellpadding='0' cellspacing='0' style='max-width:480px;'><tbody><tr><td align='right' style='padding:16px;'><table cellpadding='0' cellspacing='0'><tbody><tr><td style='font-size:14px; line-height:20px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#FFFFFF;'>예약번호: <strong>";
			content += emailVO.getReservation_number();
			content += "</strong><br>PIN: <strong>";
			content += emailVO.getPincode();
			content += "</strong></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td height='24'></td></tr></tbody></table><table align='center' cellpadding='0' cellspacing='0' style='max-width:640px;' width='100%'><tbody><tr><td align='center'><table cellpadding='0' cellspacing='0' style='max-width:640px;' width='100%'><tbody><tr><td align='left' style='padding: 0 8px;'><h1 style='font-size:24px; line-height:32px; font-weight:bold; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color: #333333; margin: 0;'>감사해요,&nbsp;";
			content += emailVO.getFirstname();
			content += "&nbsp;님!";
			content += emailVO.getCity();
			content += "&nbsp;예약이 확정되었습니다.</h1></td></tr><tr><td height='16'></td></tr><tr><td align='left' style='padding: 0 8px;'><table cellpadding='0' cellspacing='0' width='100%'><tbody><tr><td valign='top' style='padding-top: 3px;' width='24'><img alt=''  height='13' src='images/mail-check.png' style='display:block;' width='16'></td><td valign='top' style='font-size:14px; line-height:20px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color: #333333; padding-bottom: 12px;'><strong>";
			content += emailVO.getCheckin_date();
			content += "</strong>, <strong>";
			content += emailVO.getHotelname();
			content += "</strong>에서 뵙겠습니다!</td></tr><tr><td valign='top' style='padding-top: 3px;' width='24'><img alt=''  height='13' src='images/mail-check.png' style='display:block;' width='16'></td><td valign='top' style='font-size:14px; line-height:20px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color: #333333; padding-bottom: 12px;'>";
			content += "2022년 3월 12일";
			content += "PM 11:59까지 무료로 취소 가능합니다.</td></tr><tr><td valign='top' style='padding-top: 3px;' width='24'><img alt=''  height='13' src='images/mail-check.png' style='display:block;' width='16'></td><td valign='top' style='font-size:14px; line-height:20px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color: #333333; padding-bottom: 12px;'>아래 링크를 사용하여 손쉽게 예약을 <strong>변경/취소</strong>하실 수 있어요</td></tr><tr><td valign='top' style='padding-top: 3px;' width='24'><img alt=''  height='13' src='images/mail-check.png' style='display:block;' width='16'></td><td valign='top' style='font-size:14px; line-height:20px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color: #333333; padding-bottom: 12px;'>더욱 특별한 여행으로 만들어볼 기회 -&nbsp;<a href='https://secure.booking.com/upgrades.ko.html?aid=304142;label=gen000nr-10CBYoggI46AdIF1gEaLgCiAEBmAEzuAEFyAEF2AED6AEB-AEBiAIBqAIBuALoiLKQBsACAdICJDUxMjVkMjMzLTI1YzgtNDBiZS04Y2UyLWRjZDdlMDAxNDIwZtgCAeACAQ;auth_key=KCudvl63DxX8Tixo&amp;&amp;upsell_entry=email_conf_reassurance' rel='noreferrer noopener' target='_blank'>더 좋은 객실을 예약할 수 있는지 알아보세요</a></td></tr></tbody></table></td></tr><tr><td height='20'></td></tr></tbody></table><table cellpadding='0' cellspacing='0' style='max-width:640px;' width='100%'><tbody><tr><td style='font-size:20px; line-height:28px; font-weight:bold; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#333333; padding: 0 8px;'><a href='https://www.booking.com/hotel/kr/elin.html?dksc=2&amp;aid=304142&amp;label=postbooking_confemail' style='color:#333333;text-decoration:none;' target='_blank' rel='noreferrer noopener'>";
			content += emailVO.getHotelname();
			content += "</a></td></tr><tr><td><table align='left' cellpadding='0' cellspacing='0' style='max-width:320px;' width='100%'><tbody><tr><td style='padding:0 8px;'><a href='https://www.booking.com/hotel/kr/elin.html?dksc=2&amp;aid=304142&amp;label=postbooking_confemail' style='text-decoration:none;display:block;border:0;' target='_blank' rel='noreferrer noopener'><img alt='' src='/read/image/original/?mimeSN=1647753411.968094.6675.63232&amp;offset=86902&amp;size=15992&amp;u=sohui_lee&amp;cid=9d882fff8d95100409ba161493972db169be8d362c55075ba457801698caf645@MIME-Lite-HTML-1.25&amp;contentType=image/jpg&amp;filename=attach%284%29.jpg&amp;org=1' style='display:block; border-radius: 4px;' width='304'></a></td></tr></tbody></table><table align='left' cellpadding='0' cellspacing='0' style='max-width:320px;' width='100%'><tbody><tr><td style='padding:0 8px;'><a href='https://www.booking.com/directions.ko.html?hotel_id=1131080&amp;aid=304142' style='text-decoration:none;display:block;border:0;' target='_blank' rel='noreferrer noopener'><img alt='' src='/read/image/original/?mimeSN=1647753411.968094.6675.63232&amp;offset=103223&amp;size=68184&amp;u=sohui_lee&amp;cid=55dde0c9f1478dff87d9290ba645a3c28fae71e39cbfa546611954b826d0e14a@MIME-Lite-HTML-1.25&amp;contentType=image/png&amp;filename=attach%285%29.png&amp;org=1' style='display:block; border-radius: 4px;' width='304'></a></td></tr></tbody></table></td></tr><tr><td height='32'></td></tr></tbody></table><table cellpadding='0' cellspacing='0' style='max-width:640px;' width='100%'><tbody><tr><td align='left' style='padding: 0 8px;'><table align='left' cellpadding='0' cellspacing='0' style='border-collapse: separate;' width='100%'><tbody><tr><td style='border: 1px solid; padding: 16px; background-color: #FEFBF0; border-color: #FFE08A; border-radius: 4px;'><table align='left' cellpadding='0' cellspacing='0' width='100%'><tbody><tr><td valign='top' width='24'><img alt='' height='24' src='images/mail.png' width='24'></td><td width='16'></td><td valign='top' style='font-size:16px; line-height:24px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color: #333333;'>결제가 완료되었습니다.</td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td height='32'></td></tr></tbody></table><table cellpadding='0' cellspacing='0' style='max-width:640px;' width='100%'><tbody><tr><td align='left' style='font-size:16px; line-height:24px; font-weight:bold; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color: #333333; padding: 0 8px;'>예약 상세 정보</td></tr><tr><td height='16'></td></tr><tr><td style='padding: 0 8px;'><table cellpadding='0' cellspacing='0' style='border-collapse: separate;' width='100%'><tbody><tr><td style='border: 1px solid #E6E6E6; border-radius: 4px;'><table cellpadding='0' cellspacing='0' width='100%'><tbody><tr><td style=''><table cellpadding='0' cellspacing='0' style='max-width:622px; ' width='100%'><tbody><tr><td><table align='left' cellpadding='0' cellspacing='0' style='max-width:224px;' width='100%'><tbody><tr><td align='left' style='font-size:16px; line-height:24px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#6B6B6B; padding:16px;'>체크인</td></tr></tbody></table><table align='left' cellpadding='0' cellspacing='0' style='max-width:382px;' width='100%'><tbody><tr><td align='left' style='font-size:16px; line-height:24px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#333333; padding:16px;'><time datetime='2022-03-14T15:00:00+09:00'>";
			content += emailVO.getCheckin_date();
			content += "</time><span style='color:#6B6B6B; white-space:nowrap;'>";
			content += emailVO.getCheck_in_start();
			content += "&nbsp;~&nbsp;";
			content += emailVO.getCheck_in_end();
			content += "</span></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style=''><table cellpadding='0' cellspacing='0' style='max-width:622px; border-top: 1px solid #E6E6E6;' width='100%'><tbody><tr><td><table align='left' cellpadding='0' cellspacing='0' style='max-width:224px;' width='100%'><tbody><tr><td align='left' style='font-size:16px; line-height:24px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#6B6B6B; padding:16px;'>체크아웃</td></tr></tbody></table><table align='left' cellpadding='0' cellspacing='0' style='max-width:382px;' width='100%'><tbody><tr>";
			content += "<td align='left' style='font-size:16px; line-height:24px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#333333; padding:16px;'><time datetime='2022-03-15T11:00:00+09:00'>";
			content += emailVO.getCheckout_date();
			content += "</time><span style='color:#6B6B6B; white-space:nowrap;'>";
			content += emailVO.getCheck_out_end();
			content += "까지</span></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style=''><table cellpadding='0' cellspacing='0' style='max-width:622px; border-top: 1px solid #E6E6E6;' width='100%'><tbody><tr><td><table align='left' cellpadding='0' cellspacing='0' style='max-width:224px;' width='100%'><tbody><tr><td align='left' style='font-size:16px; line-height:24px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#6B6B6B; padding:16px;'>내 예약</td></tr></tbody></table><table align='left' cellpadding='0' cellspacing='0' style='max-width:382px;' width='100%'><tbody><tr><td align='left' style='font-size:16px; line-height:24px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#333333; padding:16px;'>";
			content += "1";
			content += "박, 객실&nbsp;";
			content += emailVO.getCount_room();
			content += "개</td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style=''><table cellpadding='0' cellspacing='0' style='max-width:622px; border-top: 1px solid #E6E6E6;' width='100%'><tbody><tr><td><table align='left' cellpadding='0' cellspacing='0' style='max-width:224px;' width='100%'><tbody><tr><td align='left' style='font-size:16px; line-height:24px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#6B6B6B; padding:16px;'>예약 인원</td></tr></tbody></table><table align='left' cellpadding='0' cellspacing='0' style='max-width:382px;' width='100%'><tbody><tr><td align='left' style='font-size:16px; line-height:24px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#333333; padding:16px;'>";
			content += "2";
			content += "명</td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style=''><table cellpadding='0' cellspacing='0' style='max-width:622px; border-top: 1px solid #E6E6E6;' width='100%'><tbody><tr><td><table align='left' cellpadding='0' cellspacing='0' style='max-width:224px;' width='100%'><tbody><tr><td align='left' style='font-size:16px; line-height:24px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#6B6B6B; padding:16px;'>위치</td></tr></tbody></table><table align='left' cellpadding='0' cellspacing='0' style='max-width:382px;' width='100%'><tbody><tr><td align='left' style='font-size:16px; line-height:24px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#333333; padding:16px;'><address style='font-style:normal;'>";
			content += emailVO.getCity() + ", " + emailVO.getAddress1();
			content += "</address><span style='color:#6B6B6B;'>";
			content += emailVO.getAddress2();
			content += "</span></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style=''><table cellpadding='0' cellspacing='0' style='max-width:622px; border-top: 1px solid #E6E6E6;' width='100%'><tbody><tr><td><table align='left' cellpadding='0' cellspacing='0' style='max-width:224px;' width='100%'><tbody><tr><td align='left' style='font-size:16px; line-height:24px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#6B6B6B; padding:16px;'>전화</td></tr></tbody></table><table align='left' cellpadding='0' cellspacing='0' style='max-width:382px;' width='100%'><tbody><tr><td align='left' style='font-size:16px; line-height:24px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#333333; padding:16px;'>";
			content += emailVO.getTelephone();
			content += "</td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style=''><table cellpadding='0' cellspacing='0' style='max-width:622px; border-top: 1px solid #E6E6E6;' width='100%'><tbody><tr><td><table align='left' cellpadding='0' cellspacing='0' style='max-width:224px;' width='100%'><tbody><tr><td align='left' style='font-size:16px; line-height:24px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#6B6B6B; padding:16px;'>기타 연락처</td></tr></tbody></table><table align='left' cellpadding='0' cellspacing='0' style='max-width:382px;' width='100%'><tbody><tr><td align='left' style='font-size:16px; line-height:24px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#333333; padding:16px;'>";
			content += emailVO.getMember_email();
			content += "</td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style=''><table cellpadding='0' cellspacing='0' style='max-width:622px; border-top: 1px solid #E6E6E6;' width='100%'><tbody><tr><td><table align='left' cellpadding='0' cellspacing='0' style='max-width:224px;' width='100%'><tbody><tr><td align='left' style='font-size:16px; line-height:24px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#6B6B6B; padding:16px;'>취소 정책</td></tr></tbody></table><table align='left' cellpadding='0' cellspacing='0' style='max-width:382px;' width='100%'><tbody><tr><td align='left' style='font-size:16px; line-height:24px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#333333; padding:16px;'>체크인 날짜까지&nbsp;";
			content += "하루";
			content += "&nbsp;이상 남은 경우 무료 취소가 가능합니다. 체크인 날짜까지&nbsp;";
			content += "1";
			content += "일 남은 시점부터는 취소할 경우 10%의 취소 수수료가 부과됩니다.</td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style=''><table cellpadding='0' cellspacing='0' style='max-width:622px; border-top: 1px solid #E6E6E6;' width='100%'><tbody><tr><td><table align='left' cellpadding='0' cellspacing='0' style='max-width:224px;' width='100%'><tbody><tr><td align='left' style='font-size:16px; line-height:24px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#6B6B6B; padding:16px;'>취소 수수료</td></tr></tbody></table><table align='left' cellpadding='0' cellspacing='0' style='max-width:382px;' width='100%'><tbody><tr><td align='left' style='font-size:16px; line-height:24px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#333333; padding:16px;'><ul style='margin: 0; margin-left: 20px; padding: 0;'><li>";
			content += "2022년 3월 12일";
			content += "PM 11:59";
			content += "이전: <span style='white-space:nowrap;'>₩";
			content += "0";
			content += "</span></li><li>수수료 발생 시점 - ";
			content += "2022년 3월 13일";
			content += "AM 12:00";
			content += ": <span style='white-space:nowrap;'>₩";
			content += "42,120";
			content += "</span></li></ul></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td height='32'></td></tr></tbody></table><table cellpadding='0' cellspacing='0' style='max-width:640px;' width='100%'><tbody><tr><td style='font-size:16px; line-height:24px; font-weight:bold; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color: #333333; padding: 0 8px;'>요금 상세 내역</td></tr><tr><td height='16'></td></tr><tr><td style='padding: 0 8px;'><table cellpadding='0' cellspacing='0' style='border-collapse: separate;' width='100%'><tbody><tr><td style='border: 1px solid #E6E6E6; border-radius: 4px;'><table cellpadding='0' cellspacing='0' width='100%'><tbody><tr><td><table cellpadding='0' cellspacing='0' style='max-width:622px; ' width='100%'><tbody><tr><td><table align='left' cellpadding='0' cellspacing='0' style='max-width:432px;' width='100%'><tbody><tr><td align='left' style='font-size:16px; line-height:24px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#333333; padding:8px 16px;'>";
			content += emailVO.getType();
			content += "</td></tr></tbody></table><table align='left' cellpadding='0' cellspacing='0' style='max-width:190px;' width='100%'><tbody><tr><td align='right' style='font-size:16px; line-height:24px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#333333; border-left:1px solid #E6E6E6; padding:8px 16px;'><span style='white-space:nowrap;'>₩";
			content += "38,291";
			content += "</span></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td><table cellpadding='0' cellspacing='0' style='max-width:622px; border-top: 1px solid #E6E6E6;' width='100%'><tbody><tr><td><table align='left' cellpadding='0' cellspacing='0' style='max-width:432px;' width='100%'><tbody><tr><td align='left' style='font-size:16px; line-height:24px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#333333; padding:8px 16px;'>세금 10%</td></tr></tbody></table><table align='left' cellpadding='0' cellspacing='0' style='max-width:190px;' width='100%'><tbody><tr><td align='right' style='font-size:16px; line-height:24px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#333333; border-left:1px solid #E6E6E6; padding:8px 16px;'><span style='white-space:nowrap;'>₩";
			content += "3,829";
			content += "</span></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td><table cellpadding='0' cellspacing='0' style='max-width:622px; border-top: 1px solid #E6E6E6;' width='100%'><tbody><tr><td style='background-color:#F5F5F5;'><table align='left' cellpadding='0' cellspacing='0' style='max-width:432px;' width='100%'><tbody><tr><td align='left' style='font-size:16px; line-height:24px; font-weight:bold; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#333333; padding:16px'><table cellpadding='0' cellspacing='0'><tbody><tr><td style='font-size:16px; line-height:24px; font-weight:bold; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#333333;'>합계</td></tr></tbody></table></td></tr></tbody></table><table align='left' cellpadding='0' cellspacing='0' style='max-width:190px;' width='100%'><tbody><tr><td align='right' style='font-size:16px; line-height:24px; font-weight:bold; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#333333; border-left:1px solid #E6E6E6; padding:16px'><strong style='white-space:nowrap;'>₩";
			content += emailVO.getPrice();
			content += "</strong></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td height='32'></td></tr></tbody></table><table cellpadding='0' cellspacing='0' style='max-width:640px;' width='100%'><tbody><tr><td align='left' style='font-size:16px; line-height:24px; font-weight:bold; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color: #333333; padding: 0 8px;'>";
			content += emailVO.getType();
			content += "</td></tr><tr><td height='8'></td></tr><tr><td align='left' style='font-size:14px; line-height:20px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color: #333333; padding: 0 8px;'>이";
			content += "더블룸은 퀸 사이즈의 더블침대, 평면 TV와 냉장고를 갖추고 있습니다. 전용 Wi-Fi 라우터가 객실에 제공됩니다.";
			content += "</td></tr><tr><td height='16'></td></tr><tr><td style='padding: 0 8px;'><table cellpadding='0' cellspacing='0' style='border-collapse: separate;' width='100%'><tbody><tr><td style='border: 1px solid #E6E6E6; border-radius: 4px;'><table cellpadding='0' cellspacing='0' width='100%'><tbody><tr><td style=''><table cellpadding='0' cellspacing='0' style='max-width:622px; ' width='100%'><tbody><tr><td><table align='left' cellpadding='0' cellspacing='0' style='max-width:224px;' width='100%'><tbody><tr><td align='left' style='font-size:16px; line-height:24px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#6B6B6B; padding:16px;'>투숙객</td></tr></tbody></table><table align='left' cellpadding='0' cellspacing='0' style='max-width:382px;' width='100%'><tbody><tr><td align='left' style='font-size:16px; line-height:24px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#333333; padding:16px;'>";
			content += emailVO.getLastname() + emailVO.getFirstname();
			content += "</td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style=''><table cellpadding='0' cellspacing='0' style='max-width:622px; border-top: 1px solid #E6E6E6;' width='100%'><tbody><tr><td><table align='left' cellpadding='0' cellspacing='0' style='max-width:224px;' width='100%'><tbody><tr><td align='left' style='font-size:16px; line-height:24px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#6B6B6B; padding:16px;'>정원</td></tr></tbody></table><table align='left' cellpadding='0' cellspacing='0' style='max-width:382px;' width='100%'><tbody><tr><td align='left' style='font-size:16px; line-height:24px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#333333; padding:16px;'>";
			content += "2";
			content += "명</td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td style=''><table cellpadding='0' cellspacing='0' style='max-width:622px; border-top: 1px solid #E6E6E6;' width='100%'><tbody><tr><td><table align='left' cellpadding='0' cellspacing='0' style='max-width:224px;' width='100%'><tbody><tr><td align='left' style='font-size:16px; line-height:24px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#6B6B6B; padding:16px;'>식사 계획</td></tr></tbody></table><table align='left' cellpadding='0' cellspacing='0' style='max-width:382px;' width='100%'><tbody><tr><td align='left' style='font-size:16px; line-height:24px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#333333; padding:16px;'>";
			content += "이 객실 요금에는 식사 요금이 포함되어 있지 않습니다.";
			content += "</td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td height='32'></td></tr></tbody></table><table cellpadding='0' cellspacing='0' style='max-width:640px;' width='100%'><tbody><tr><td style='padding: 0 8px;'><table align='left' cellpadding='0' cellspacing='0' style='border-collapse: separate;' width='100%'><tbody><tr><td style='border: 1px solid; padding: 16px; background-color: #FEFBF0; border-color: #FFE08A; border-radius: 4px;'><table align='left' cellpadding='0' cellspacing='0' width='100%'><tbody><tr><td valign='top' width='24'><img alt='' height='24' src='images/mail.png' width='24'></td><td width='16'></td><td valign='top' style='font-size:14px; line-height:20px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color: #333333;'><b>중요 공지사항</b><br>";
			content += "국가/지역에 따라 관광 목적의 여행이 허용되지 않을 수 있으므로, 여행 전에 필요한 정보를 반드시 확인하시기 바랍니다. 계획이 바뀌어 예약을 변경하셔야 할 경우 아래 링크를 클릭하여 어떤 옵션이 있는지 확인해보세요.";
			content += "</td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td height='32'></td></tr></tbody></table><table cellpadding='0' cellspacing='0' style='max-width:640px;' width='100%'><tbody><tr><td align='left' style='padding: 0 8px;'><table align='left' cellpadding='0' cellspacing='0'><tbody><tr><td style='padding-bottom: 8px;'><table align='center' cellpadding='0' cellspacing='0' style='background:#0071C2; border-collapse:separate;border-radius:2px;'><tbody><tr><td style='font-size:16px; line-height:24px; font-weight:bold; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; padding:12px 24px;'><a href='https://secure.booking.com/myreservations.ko.html?aid=304142;bn=2906477400;pincode=5730&amp;;source=conf_email;pbsource=conf_email_modify;pbtrack=email_mainCTA' style='text-decoration:none; color:#FFFFFF;' target='_blank' rel='noreferrer noopener'>예약 변경하기</a></td></tr></tbody></table></td></tr></tbody></table><table align='left' cellpadding='0' cellspacing='0'><tbody><tr><td style='font-size:16px; line-height:24px; font-weight:bold; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; padding:12px 24px;'><a href='https://secure.booking.com/myreservations.ko.html?aid=304142;bn=2906477400;pincode=5730&amp;;source=conf_email;pbsource=conf_email_modify;label=conf_email_print;pbtrack=email_print_btn' style='text-decoration:none; color:#0071C2;' target='_blank' rel='noreferrer noopener'>프린트 버전 보기&nbsp;»</a></td></tr></tbody></table></td></tr><tr><td height='40'></td></tr></tbody></table>";
			content += "<table cellpadding='0' cellspacing='0' style='max-width:640px;' width='100%'><tbody><tr><td style='padding: 0px 8px;'><table cellpadding='0' cellspacing='0' width='100%'><tbody><tr><td align='left' valign='top' width='48'><img alt='' height='auto' src='images/mail-booking.png' style='display:block;' width='32'></td><td><table align='left' cellpadding='0' cellspacing='0'><tbody><tr><td align='left' style='font-size:20px; line-height:28px; font-weight:bold; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color: #333333; padding-top: 2px;'>예약 변경/취소</td></tr><tr><td align='left' style='padding-top: 8px;'><table align='left' cellpadding='0' cellspacing='0' width='100%'><tbody><tr><td style='font-size:16px; line-height:24px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color: #333333;'>더욱 간편하게 예약을 변경 또는 취소하실 수 있어요. 예약 정책에 따라 취소 위약금이 발생할 수 있습니다.</td></tr><tr><td style='padding-top: 16px;'><table align='left' cellpadding='0' cellspacing='0'><tbody><tr><td style='font-size:16px; line-height:24px; font-weight:bold; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;'><a href='https://secure.booking.com/apps.ko.html?aid=304142;label=gen000nr-10CBYoggI46AdIF1gEaLgCiAEBmAEzuAEFyAEF2AED6AEB-AEBiAIBqAIBuALoiLKQBsACAdICJDUxMjVkMjMzLTI1YzgtNDBiZS04Y2UyLWRjZDdlMDAxNDIwZtgCAeACAQ' style=' text-decoration:none; color:#0071C2;' target='_blank' rel='noreferrer noopener'>예약 변경/취소하기&nbsp;»</a></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td height='32'></td></tr></tbody></table>";
			content += "<table cellpadding='0' cellspacing='0' style='max-width:640px;' width='100%'><tbody><tr><td style='padding: 0px 8px;'><table cellpadding='0' cellspacing='0' width='100%'><tbody><tr><td align='left' valign='top' width='48'><img alt='' height='auto' src='images/mail-chat.png' style='display:block;' width='32'></td><td><table align='left' cellpadding='0' cellspacing='0'><tbody><tr><td align='left' style='font-size:20px; line-height:28px; font-weight:bold; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color: #333333; padding-top: 2px;'>숙소와의 연락</td></tr><tr><td align='left' style='padding-top: 8px;'><table align='left' cellpadding='0' cellspacing='0' width='100%'><tbody><tr><td style='font-size:16px; line-height:24px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color: #333333;'>문의사항 또는 요청사항이 있으신가요? 앱을 통해 숙소와 직접 채팅하실 수 있어요.</td></tr><tr><td style='padding-top: 16px;'><table align='left' cellpadding='0' cellspacing='0'><tbody><tr><td style='font-size:16px; line-height:24px; font-weight:bold; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;'><a href='https://secure.booking.com/apps.ko.html?aid=304142;label=gen000nr-10CBYoggI46AdIF1gEaLgCiAEBmAEzuAEFyAEF2AED6AEB-AEBiAIBqAIBuALoiLKQBsACAdICJDUxMjVkMjMzLTI1YzgtNDBiZS04Y2UyLWRjZDdlMDAxNDIwZtgCAeACAQ' style=' text-decoration:none; color:#0071C2;' target='_blank' rel='noreferrer noopener'>숙소와 채팅하기&nbsp;»</a></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td height='32'></td></tr></tbody></table><table cellpadding='0' cellspacing='0' style='max-width:640px;' width='100%'><tbody><tr><td style='padding: 0px 8px;'><table cellpadding='0' cellspacing='0' width='100%'><tbody><tr><td align='left' valign='top' width='48'><img alt='' height='auto' src='images/mail-attach.png' style='display:block;' width='32'></td><td><table align='left' cellpadding='0' cellspacing='0'><tbody><tr><td align='left' style='font-size:20px; line-height:28px; font-weight:bold; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color: #333333; padding-top: 2px;'>안심하고 여행하세요</td></tr><tr><td align='left' style='padding-top: 8px;'><table align='left' cellpadding='0' cellspacing='0' width='100%'><tbody><tr><td style='font-size:16px; line-height:24px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color: #333333;'>웹사이트와 앱을 통해 저희 안전보안 자료 센터를 이용해보세요. 안전한 여행에 도움이 되는 정보를 확인하실 수 있습니다.</td></tr><tr><td style='padding-top: 16px'><table align='left' cellpadding='0' cellspacing='0'><tbody><tr><td style='font-size:16px; line-height:24px; font-weight:bold; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;'><a href='https://secure.booking.com/apps.ko.html?aid=304142;label=gen000nr-10CBYoggI46AdIF1gEaLgCiAEBmAEzuAEFyAEF2AED6AEB-AEBiAIBqAIBuALoiLKQBsACAdICJDUxMjVkMjMzLTI1YzgtNDBiZS04Y2UyLWRjZDdlMDAxNDIwZtgCAeACAQ' style=' text-decoration:none; color:#0071C2;' target='_blank' rel='noreferrer noopener'>홈페이지 바로가기&nbsp;»</a></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table>";
			content += "<table cellpadding='0' cellspacing='0' width='100%'><tbody><tr><td height='24'></td></tr><tr><td align='center' style='background-color:#F5F5F5; border-top: solid 1px #E6E6E6;' width='100%'><table align='center' cellpadding='0' cellspacing='0' style='max-width:640px;' width='100%'><tbody><tr><td align='center' style='padding: 0px 8px;'><table align='center' cellpadding='0' cellspacing='0' width='100%'><tbody><tr><td style='padding: 48px 0px;'><table align='center' cellpadding='0' cellspacing='0' style='margin: 0 auto;' width='100%'><tbody><tr><td align='left' style='font-size:20px; line-height:28px; font-weight:bold; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#000000;'>Booqueen.com</td></tr><tr><td align='left' style='font-size:14px; line-height:20px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color:#000000; padding: 12px 0 24px 0;'>서울특별시 종로구 돈화문로 26, 4층(묘동, 단성사)</td></tr><tr><td align='left' style='font-size:14px; line-height:20px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color: #333333; padding: 8px 0;'>저작권 © 2022- Booqueen.com. 모든 권리 보유.</td></tr><tr><td align='left' style='font-size:14px; line-height:20px; font-weight:normal; font-family:BlinkMacSystemFont, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color: #333333; padding: 8px 0;'>Booqueen.com을 통하여 숙소와 연락하실 경우 저희&nbsp;<a href='https://www.booking.com/content/privacy.ko.html?aid=304142;label=gen000nr-10CBYoggI46AdIF1gEaLgCiAEBmAEzuAEFyAEF2AED6AEB-AEBiAIBqAIBuALoiLKQBsACAdICJDUxMjVkMjMzLTI1YzgtNDBiZS04Y2UyLWRjZDdlMDAxNDIwZtgCAeACAQ' style='color: #0071C2;' target='_blank' rel='noreferrer noopener'>개인 정보 보호 정책</a>에 동의하게 됩니다.</td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table>";

			message.setContent(content, "text/html");
			return message;
		} catch (Exception ex) {
			Logger.getLogger(SendEmail.class.getName()).log(Level.SEVERE, null, ex);
		}
		return null;
	}
}
